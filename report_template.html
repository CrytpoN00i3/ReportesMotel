<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informe - {{ report_metadata.motel_name }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; color: #1f2937; -webkit-print-color-adjust: exact; }
        .page { background-color: white; width: 210mm; min-height: 297mm; margin: 20px auto; padding: 20mm; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        @media print {
            body { background-color: white; }
            .page { margin: 0; box-shadow: none; width: 100%; page-break-after: always; }
            .no-print { display: none; }
        }
        .metric-card { border: 1px solid #e5e7eb; border-radius: 8px; padding: 1rem; background-color: #ffffff; }
        .trend-down { color: #dc2626; }
        .trend-up { color: #16a34a; }
        .trend-neutral { color: #9ca3af; }
        .chart-container { position: relative; height: 250px; width: 100%; }
    </style>
</head>
<body>
    <div class="page">
        <!-- Header -->
        <header class="border-b-2 border-gray-800 pb-6 mb-8 flex justify-between items-end">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 uppercase tracking-wide">Informe de Rendimiento</h1>
                <p class="text-gray-500 mt-2">Análisis de Redes Sociales y Audiencia</p>
            </div>
            <div class="text-right">
                <h2 class="text-xl font-semibold text-gray-800">{{ report_metadata.motel_name }}</h2>
                <p class="text-sm text-gray-600">Periodo: {{ report_metadata.period }}</p>
            </div>
        </header>

        <!-- Executive Summary -->
        <section class="mb-10">
            <h3 class="text-lg font-bold text-gray-800 border-l-4 border-blue-600 pl-3 mb-4 uppercase">Resumen Ejecutivo</h3>
            <div class="grid grid-cols-4 gap-4">
                <div class="metric-card">
                    <p class="text-xs text-gray-500 uppercase font-semibold">Total Visualizaciones (FB)</p>
                    <p class="text-2xl font-bold">{{ "{:,}".format(facebook.views) }}</p>
                    {% if facebook.views_trend > 0 %}
                        <p class="text-xs font-medium trend-up">▲ {{ facebook.views_trend }}% vs periodo ant.</p>
                    {% else %}
                        <p class="text-xs font-medium trend-neutral">--</p>
                    {% endif %}
                </div>
                <div class="metric-card">
                    <p class="text-xs text-gray-500 uppercase font-semibold">Total Visualizaciones (IG)</p>
                    <p class="text-2xl font-bold">{{ "{:,}".format(instagram.views) }}</p>
                    {% if instagram.views_trend > 0 %}
                        <p class="text-xs font-medium trend-up">▲ {{ instagram.views_trend }}% vs periodo ant.</p>
                    {% else %}
                        <p class="text-xs font-medium trend-neutral">--</p>
                    {% endif %}
                </div>
                <!-- Hardcoded for now, or extractable if in screenshots -->
                <div class="metric-card">
                    <p class="text-xs text-gray-500 uppercase font-semibold">Interacciones (IG)</p>
                    <p class="text-2xl font-bold">{{ instagram.interactions }}</p>
                    {% if instagram.interactions_trend > 0 %}
                        <p class="text-xs font-medium trend-up">▲ {{ instagram.interactions_trend }}% vs periodo ant.</p>
                    {% else %}
                        <p class="text-xs font-medium trend-neutral">--</p>
                    {% endif %}
                </div>
            </div>
        </section>

        <!-- Facebook Analysis -->
        <section class="mb-10">
            <h3 class="text-lg font-bold text-gray-800 border-l-4 border-blue-800 pl-3 mb-4 uppercase">Facebook: Análisis de Desempeño</h3>
            <div class="grid grid-cols-2 gap-8">
                <div>
                    <table class="w-full text-sm text-left text-gray-600">
                        <thead class="text-xs text-gray-700 uppercase bg-gray-100">
                            <tr><th class="px-4 py-2">Métrica</th><th class="px-4 py-2">Valor</th><th class="px-4 py-2">Tendencia</th></tr>
                        </thead>
                        <tbody>
                            <tr class="border-b">
                                <td class="px-4 py-3">Visualizaciones</td><td class="font-medium">{{ "{:,}".format(facebook.views) }}</td>
                                <td>{% if facebook.views_trend > 0 %}<span class="trend-up">▲ {{ facebook.views_trend }}%</span>{% else %}<span class="trend-neutral">--</span>{% endif %}</td>
                            </tr>
                            <tr class="border-b">
                                <td class="px-4 py-3">Usuarios Alcanzados</td><td class="font-medium">{{ "{:,}".format(facebook.reach) }}</td>
                                <td>{% if facebook.reach_trend > 0 %}<span class="trend-up">▲ {{ facebook.reach_trend }}%</span>{% else %}<span class="trend-neutral">--</span>{% endif %}</td>
                            </tr>
                            <tr class="border-b">
                                <td class="px-4 py-3">Visitas al Perfil</td><td class="font-medium">{{ "{:,}".format(facebook.visits) }}</td>
                                <td>{% if facebook.visits_trend > 0 %}<span class="trend-up">▲ {{ facebook.visits_trend }}%</span>{% else %}<span class="trend-neutral">--</span>{% endif %}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div>
                    <!-- Placeholder Chart Logic -->
                    <h4 class="text-sm font-semibold text-gray-700 mb-2 text-center">Interacciones vs Alcance</h4>
                    <div class="chart-container"><canvas id="fbChart"></canvas></div>
                </div>
            </div>
        </section>

        <!-- Demographics -->
        <section class="mb-10">
             <h3 class="text-lg font-bold text-gray-800 border-l-4 border-purple-600 pl-3 mb-4 uppercase">Perfil Demográfico</h3>
             <div class="grid grid-cols-2 gap-8">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h4 class="text-sm font-bold text-gray-700 mb-4 text-center">Distribución por Sexo</h4>
                    <div class="flex justify-center items-center h-40"><canvas id="genderChart"></canvas></div>
                    <div class="flex justify-center mt-4 gap-6 text-sm">
                        <div class="flex items-center"><span class="w-3 h-3 bg-blue-500 rounded-full mr-2"></span>Hombres: {{ demographics.gender.men_percentage }}%</div>
                        <div class="flex items-center"><span class="w-3 h-3 bg-pink-500 rounded-full mr-2"></span>Mujeres: {{ demographics.gender.women_percentage }}%</div>
                    </div>
                </div>
                <div>
                    <h4 class="text-sm font-bold text-gray-700 mb-3">Principales Ciudades</h4>
                    <div class="space-y-3">
                        {% for city in demographics.top_cities %}
                        <div>
                            <div class="flex justify-between text-xs font-semibold mb-1">
                                <span>{{ city.city }}</span><span>{{ city.percentage }}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-600 h-2 rounded-full" style="width: {{ city.percentage }}%"></div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
             </div>
        </section>
        
        <footer class="text-center text-xs text-gray-400 mt-auto pt-10 border-t">
            <p>Generado automáticamente el {{ generation_date }}</p>
        </footer>
    </div>

    <script>
        // Inject Data from Python to JS
        const genderData = [{{ demographics.gender.men_percentage }}, {{ demographics.gender.women_percentage }}];
        
        // Gender Chart
        new Chart(document.getElementById('genderChart'), {
            type: 'pie',
            data: {
                labels: ['Hombres', 'Mujeres'],
                datasets: [{ data: genderData, backgroundColor: ['#3b82f6', '#ec4899'], borderWidth: 0 }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
        });
        
        // Generic Chart for visual balance
        new Chart(document.getElementById('fbChart'), {
            type: 'bar',
            data: {
                labels: ['Visualizaciones', 'Alcance'],
                datasets: [{ 
                    label: 'Métricas Actuales', 
                    data: [{{ facebook.views }}, {{ facebook.reach }}], 
                    backgroundColor: ['#3b82f6', '#93c5fd'] 
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
        });
    </script>
</body>
</html>
